<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Honest News – Home</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <!-- Optional: your main stylesheet if you want to keep your existing styles -->
  <!-- <link rel="stylesheet" href="assets/css/main.css"> -->

  <style>
    /* Simple demo styles – won't replace your main.css */
    body{
      margin:0;
      font-family:system-ui,-apple-system,BlinkMacSystemFont,"SF Pro Text","Segoe UI",sans-serif;
      background:#020617;
      color:#e5e7eb;
      min-height:100vh;
      display:flex;
      flex-direction:column;
    }

    .hn-header{
      position:sticky;
      top:0;
      z-index:50;
      background:rgba(15,23,42,0.94);
      backdrop-filter:blur(12px);
      border-bottom:1px solid rgba(148,163,184,0.35);
      display:flex;
      align-items:center;
      justify-content:space-between;
      padding:10px 20px;
    }
    .hn-logo{
      font-weight:700;
      letter-spacing:.16em;
      text-transform:uppercase;
      font-size:.8rem;
      color:#e5e7eb;
    }

    .hn-nav{
      display:flex;
      gap:18px;
      align-items:center;
    }
    .hn-nav a{
      text-decoration:none;
      font-size:.9rem;
      color:#cbd5f5;
      padding:4px 2px;
      border-bottom:2px solid transparent;
    }
    .hn-nav a:hover{
      color:#fff;
      border-bottom-color:#0ea5e9;
    }

    /* Mega menu container */
    .hn-mega-backdrop{
      position:absolute;
      left:0;
      right:0;
      top:56px; /* just under header */
      display:none;
      justify-content:center;
      pointer-events:none;
    }
    .hn-mega-backdrop.show{
      display:flex;
      pointer-events:auto;
    }
    .hn-mega{
      margin-top:4px;
      background:#020617;
      border-radius:16px;
      border:1px solid rgba(148,163,184,0.4);
      box-shadow:0 25px 60px rgba(0,0,0,.85);
      max-width:900px;
      width:100%;
      padding:16px 18px;
    }
    .hn-mega-title{
      font-size:.8rem;
      text-transform:uppercase;
      letter-spacing:.16em;
      color:#9ca3af;
      margin-bottom:10px;
    }
    .hn-mega-grid{
      display:grid;
      grid-template-columns:repeat(3,minmax(0,1fr));
      gap:12px;
    }
    .hn-mega-link{
      display:block;
      padding:10px;
      border-radius:12px;
      text-decoration:none;
      background:#020617;
      border:1px solid rgba(31,41,55,.9);
      color:#e5e7eb;
    }
    .hn-mega-link-title{
      font-size:.9rem;
      font-weight:600;
      margin-bottom:4px;
    }
    .hn-mega-link-desc{
      font-size:.78rem;
      color:#9ca3af;
    }
    .hn-mega-link:hover{
      border-color:#0ea5e9;
      box-shadow:0 0 0 1px rgba(56,189,248,.4);
    }

    /* Mobile */
    .hn-burger{
      display:none;
      border:none;
      background:transparent;
      color:#e5e7eb;
      font-size:1.2rem;
      cursor:pointer;
    }
    .hn-mobile{
      display:none;
      flex-direction:column;
      background:#020617;
      border-top:1px solid rgba(31,41,55,.9);
    }
    .hn-mobile a{
      padding:10px 18px;
      text-decoration:none;
      font-size:.95rem;
      color:#e5e7eb;
      border-bottom:1px solid rgba(31,41,55,.9);
    }

    @media (max-width:768px){
      .hn-nav{display:none;}
      .hn-burger{display:block;}
      .hn-mega-backdrop{display:none !important;} /* mega on desktop only */
    }

    .hero{
      flex:1;
      display:flex;
      align-items:center;
      justify-content:center;
      padding:60px 20px;
      text-align:center;
      background:
        radial-gradient(circle at top,#1e293b 0,#020617 48%,#000 100%);
    }
    .hero h1{
      font-size:2.3rem;
      margin:0 0 .6rem;
    }
    .hero p{
      max-width:600px;
      margin:0 auto;
      font-size:1rem;
      color:#9ca3af;
    }
    .hero a{
      display:inline-block;
      margin-top:1.2rem;
      padding:0.7rem 1.8rem;
      border-radius:999px;
      text-decoration:none;
      background:#0ea5e9;
      color:#0b1120;
      font-weight:600;
      font-size:.9rem;
    }
  </style>
</head>
<body data-page="home">

<header class="hn-header">
  <div class="hn-logo">HONEST NEWS</div>

  <nav class="hn-nav" id="hnNav"></nav>

  <button class="hn-burger" id="hnBurger" aria-label="Toggle menu">☰</button>
</header>

<!-- Mega menu overlay -->
<div class="hn-mega-backdrop" id="hnMegaBackdrop">
  <div class="hn-mega" id="hnMegaPanel">
    <div class="hn-mega-title" id="hnMegaTitle">Explore</div>
    <div class="hn-mega-grid" id="hnMegaInner"></div>
  </div>
</div>

<div class="hn-mobile" id="hnMobileNav"></div>

<main class="hero">
  <div>
    <h1>Home page (index.html)</h1>
    <p>
      This is a simple test page wired to <code>site-data.json</code>.
      Use the dashboard to edit the menu and mega menu and then click “Publish”.
    </p>
    <a href="about.html">Go to About page</a>
  </div>
</main>

<script>
  let site = { menu: [] };

  async function loadSiteData(){
    try{
      const res = await fetch("site-data.json?cache-bust=" + Date.now());
      if(res.ok){
        const data = await res.json();
        if (data && Array.isArray(data.menu)){
          site.menu = data.menu;
        }
      }
    }catch(e){
      console.warn("Could not load site-data.json", e);
    }
    buildNav();
  }

  function buildNav(){
    const nav = document.getElementById("hnNav");
    const mobile = document.getElementById("hnMobileNav");
    if(!nav || !mobile) return;

    nav.innerHTML = "";
    mobile.innerHTML = "";

    (site.menu || []).forEach((item,index)=>{
      const label = item.label || item.title || "Item";
      const url = item.url || "#";
      const type = item.type || "link";

      // Desktop link
      const a = document.createElement("a");
      a.textContent = label;
      a.href = url;
      a.dataset.type = type;
      a.dataset.index = index;

      if (type === "mega"){
        a.addEventListener("mouseenter", ()=>openMega(index));
      } else {
        a.addEventListener("mouseenter", closeMega);
      }
      nav.appendChild(a);

      // Mobile link (no mega UI, just a list)
      const m = document.createElement("a");
      m.textContent = label;
      m.href = url;
      mobile.appendChild(m);
    });

    // If you move mouse off header/mega, close it
    document.querySelector(".hn-header").addEventListener("mouseleave", (e)=>{
      if (!e.relatedTarget || !e.relatedTarget.closest("#hnMegaPanel")){
        closeMega();
      }
    });
    document.getElementById("hnMegaPanel").addEventListener("mouseleave", closeMega);
  }

  function openMega(index){
    const item = (site.menu || [])[index];
    if (!item || item.type !== "mega") return;
    const subs = Array.isArray(item.subItems) ? item.subItems : [];
    const inner = document.getElementById("hnMegaInner");
    const title = document.getElementById("hnMegaTitle");
    const backdrop = document.getElementById("hnMegaBackdrop");
    if (!inner || !title || !backdrop) return;

    title.textContent = item.label || "Explore";
    inner.innerHTML = subs.map(s=>{
      const l = (s.label || s.title || "Link");
      const u = (s.url || "#");
      const d = (s.description || "");
      return `
        <a class="hn-mega-link" href="${u}">
          <div class="hn-mega-link-title">${escapeHtml(l)}</div>
          <div class="hn-mega-link-desc">${escapeHtml(d)}</div>
        </a>
      `;
    }).join("");

    backdrop.classList.add("show");
  }

  function closeMega(){
    const backdrop = document.getElementById("hnMegaBackdrop");
    if(backdrop) backdrop.classList.remove("show");
  }

  function escapeHtml(str){
    return String(str || "")
      .replace(/&/g,"&amp;")
      .replace(/</g,"&lt;")
      .replace(/>/g,"&gt;")
      .replace(/"/g,"&quot;");
  }

  // Mobile toggle
  const burger = document.getElementById("hnBurger");
  const mobile = document.getElementById("hnMobileNav");
  if (burger && mobile){
    burger.addEventListener("click", ()=>{
      mobile.style.display = mobile.style.display === "flex" ? "none" : "flex";
    });
  }

  loadSiteData();
</script>
</body>
</html>
