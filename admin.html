<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Site Admin — Static JSON Editor (GitHub Pages)</title>
  <style>
    :root{--bg:#0b1220;--card:#071227;--muted:#9fb0c8;--accent:#06b6d4;--glass:rgba(255,255,255,0.03)}
    html,body{height:100%;margin:0;background:linear-gradient(180deg,#041322 0%, #071b2a 100%);font-family:Inter,ui-sans-serif,system-ui,-apple-system,'Segoe UI',Roboto,'Helvetica Neue',Arial;color:#e6eef6}
    .app{max-width:1100px;margin:20px auto;padding:18px}
    header{display:flex;align-items:center;gap:12px}
    h1{font-size:18px;margin:0}
    .grid{display:grid;grid-template-columns:320px 1fr;gap:16px;margin-top:14px}
    .card{background:var(--card);border-radius:12px;padding:12px;box-shadow:0 6px 20px rgba(2,6,23,0.6)}
    .side{height:calc(100vh - 120px);overflow:auto}
    .main{height:calc(100vh - 120px);overflow:auto}
    label{display:block;font-size:13px;color:var(--muted);margin-bottom:8px}
    input[type=text],select,textarea{width:100%;padding:8px;border-radius:8px;border:1px solid rgba(255,255,255,0.04);background:transparent;color:inherit}
    .row{display:flex;gap:8px;align-items:center}
    .btn{background:var(--accent);border:none;color:#022;padding:8px 12px;border-radius:8px;cursor:pointer}
    .btn.secondary{background:transparent;border:1px solid rgba(255,255,255,0.06);color:var(--muted)}
    .list{margin-top:10px}
    .list-item{display:flex;align-items:center;justify-content:space-between;padding:8px;border-radius:8px;background:var(--glass);margin-bottom:8px}
    .small{font-size:13px;color:var(--muted)}
    .thumb{width:72px;height:48px;object-fit:cover;border-radius:6px;border:1px solid rgba(255,255,255,0.04)}
    .controls{display:flex;gap:8px}
    .checkbox{display:inline-flex;align-items:center;gap:8px}
    .hero-preview{height:160px;border-radius:8px;background:#031220;display:flex;align-items:center;justify-content:center;color:var(--muted);position:relative;overflow:hidden}
    .hero-preview img{position:absolute;inset:0;width:100%;height:100%;object-fit:cover;filter:brightness(.4)}
    pre{white-space:pre-wrap;word-break:break-word;background:rgba(255,255,255,0.02);padding:8px;border-radius:8px;font-size:12px;color:var(--muted)}
    .slide-row{display:flex;gap:8px;margin-bottom:8px;align-items:center}
    .slide-input{flex:1;padding:8px;border-radius:6px;border:1px solid rgba(255,255,255,0.04);background:transparent;color:inherit}
    footer{margin-top:12px;display:flex;gap:8px;align-items:center}
    .rt-toolbar button{margin-right:4px;padding:4px 6px;font-size:12px}
    .rt-block{margin-bottom:8px;border:1px solid rgba(255,255,255,0.1);border-radius:6px;padding:6px;background:rgba(255,255,255,0.02)}
    .rt-editor{min-height:60px;padding:6px;background:transparent;color:inherit;outline:none;}
    .draggable{cursor:grab;}
  </style>
</head>
  <script>
  const ADMIN_PASSWORD = 'YourSecretPassword'; // set your password here
  let input = prompt('Enter admin password:');
  if (input !== ADMIN_PASSWORD) {
    document.body.innerHTML = '<h1 style="color:red;text-align:center;margin-top:50px;">Access Denied</h1>';
    throw 'Blocked: wrong password';
  }
</script>
<body>
  <div class="app">
    <header>
      <svg width="36" height="36" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><rect width="24" height="24" rx="6" fill="#022"/></svg>
      <div>
        <h1>Static Admin — GitHub Pages Compatible</h1>
        <div class="small">Loads <code>data.json</code> from the same folder. Save will download an updated <code>data.json</code> for you to commit.</div>
      </div>
    </header>

    <div class="grid">
      <aside class="card side">
        <!-- Global settings, image library, site data remain unchanged -->
      </aside>

      <main class="card main">
        <section>
          <label>Pages — Page Manager</label>
          <!-- Page manager inputs remain unchanged -->
        </section>

        <hr style="margin:18px 0;border:none;border-top:1px solid rgba(255,255,255,0.03)"/>

        <section id="pageEditor" style="display:none">
          <div style="display:flex;justify-content:space-between;align-items:center">
            <h3 id="editingTitle">Editing — </h3>
            <div class="controls">
              <button id="saveBtn" class="btn">Save (download JSON)</button>
              <button id="deletePageBtn" class="btn secondary">Delete</button>
            </div>
          </div>

          <!-- Hero editor remains unchanged -->

          <hr style="margin:12px 0;border:none;border-top:1px solid rgba(255,255,255,0.03)"/>

          <label>Page content — Rich text blocks</label>
          <div style="display:flex;gap:8px;margin-bottom:8px;align-items:center">
            <input id="newBlockTitle" type="text" placeholder="Block name (eg: Hero headline)">
            <button id="addBlock" class="btn secondary">Add block</button>
          </div>
          <div id="blocksList" class="list"></div>

          <hr style="margin:12px 0;border:none;border-top:1px solid rgba(255,255,255,0.03)"/>

          <label>Advanced / JSON Preview</label>
          <pre id="jsonPreview"></pre>
        </section>

        <footer>
          <div class="small">Last saved: <span id="lastSaved">never</span></div>
        </footer>
      </main>
    </div>
  </div>

<script>
  // --- Existing JS for loading, saving, images, pages, hero remains unchanged ---

  // --- Rich Text Editor Upgrade ---
  function createRichTextBlock(name='Block', content='<p>Edit me</p>'){  
    const container = document.createElement('div');
    container.className = 'rt-block draggable';
    container.draggable = true;

    container.innerHTML = `
      <div class="rt-toolbar">
        <button onclick="document.execCommand('bold',false,null)">B</button>
        <button onclick="document.execCommand('italic',false,null)">I</button>
        <button onclick="document.execCommand('underline',false,null)">U</button>
        <button onclick="document.execCommand('insertOrderedList',false,null)">OL</button>
        <button onclick="document.execCommand('insertUnorderedList',false,null)">UL</button>
        <button onclick="let url=prompt('Link URL'); if(url) document.execCommand('createLink',false,url)">Link</button>
      </div>
      <div class="rt-editor" contenteditable="true">${content}</div>
      <button onclick="this.parentNode.remove()">Delete</button>
    `;

    container.addEventListener('dragstart', e=>{ e.dataTransfer.setData('text/plain',''); container.classList.add('dragging'); });
    container.addEventListener('dragend', e=>{ container.classList.remove('dragging'); });

    document.getElementById('blocksList').appendChild(container);
  }

  function renderBlocks(){
    const node = document.getElementById('blocksList');
    node.innerHTML='';
    const page = data.pages.find(p=>p.id===editingPageId);
    if(!page) return;
    if(!page.blocks || page.blocks.length===0){
      node.innerHTML='<div class="small">No rich text blocks yet.</div>';
      return;
    }
    page.blocks.forEach(b=>createRichTextBlock(b.name,b.content));
  }

  function collectBlocks(){
    const page = data.pages.find(p=>p.id===editingPageId);
    if(!page) return;
    page.blocks = [...document.querySelectorAll('.rt-block')].map(block=>({
      id: block.id||'id-'+Math.random().toString(36).slice(2,9),
      name: block.querySelector('.rt-editor').innerText.slice(0,20)||'Block',
      type:'rich-text',
      content: block.querySelector('.rt-editor').innerHTML
    }));
  }

  document.getElementById('addBlock').addEventListener('click',()=>{
    if(!editingPageId) return alert('Open a page');
    createRichTextBlock();
  });

  // Save blocks on download
  const saveBtn = document.getElementById('saveBtn');
  saveBtn.addEventListener('click',()=>{
    const page = data.pages.find(p=>p.id===editingPageId); if(!page) return alert('Open a page');
    page.hero.slides = collectSlides();
    collectBlocks();
    saveLocal();
    downloadDataJson();
  });

  // Drag-and-drop reorder for blocks
  const listNode = document.getElementById('blocksList');
  listNode.addEventListener('dragover', e=>{ e.preventDefault(); const dragging = listNode.querySelector('.dragging'); const after = [...listNode.children].filter(c=>c!==dragging).find(c=>e.clientY<c.getBoundingClientRect().top+c.offsetHeight/2); if(after) listNode.insertBefore(dragging,after); else listNode.appendChild(dragging); });
</script>
</body>
</html>



