<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>HNN Admin</title>
<style>
  body{font-family:system-ui;background:#f4f4f4;padding:2rem;color:#222}
  .panel{max-width:1000px;margin:auto;background:white;padding:2rem;border-radius:12px;box-shadow:0 10px 30px rgba(0,0,0,0.1)}
  input,select{width:100%;padding:12px;margin:8px 0;border:1px solid #ddd;border-radius:6px}
  button{padding:12px 24px;background:#0066cc;color:white;border:none;border-radius:6px;cursor:pointer}
  .tab button{margin-right:8px;padding:10px 20px}
  .tabcontent{display:none;padding:2rem 0}
  .tabcontent.active{display:block}
  .slide{margin:2rem 0;padding:1.5rem;background:#fafafa;border-radius:8px}
  input[type=color]{height:60px}
</style>
</head>
<body>

<div style="text-align:center;margin-top:100px">
  <h1>Honest News Network Admin</h1>
  <p>Type the secret word:</p>
  <input type="password" id="secretInput" style="font-size:2rem;padding:12px">
  <button onclick="check()">Enter</button>
</div>

<div id="panel" class="panel" style="display:none">
  <h1>Live Site Editor</h1>

  <div class="tab">
    <button class="active" onclick="openTab('home')">Home Hero</button>
    <button onclick="openTab('podcast')">Podcast Hero</button>
    <button onclick="openTab('blog')">Blog Hero</button>
    <button onclick="openTab('shop')">Shop Hero</button>
  </div>

  <div id="home" class="tabcontent active"><h2>Home Page Slides</h2><div id="slides-home"></div></div>
  <div id="podcast" class="tabcontent"><h2>Podcast Page Slides</h2><div id="slides-podcast"></div></div>
  <div id="blog" class="tabcontent"><h2>Blog Page Slides</h2><div id="slides-blog"></div></div>
  <div id="shop" class="tabcontent"><h2>Shop Page Slides</h2><div id="slides-shop"></div></div>

  <button onclick="addSlide(currentPage)">+ Add Slide to Current Tab</button>
  <button onclick="saveAll()" style="margin-left:20px;background:#c00">SAVE ALL CHANGES</button>
  <p id="status" style="margin-top:20px;font-weight:bold"></p>
</div>

<script>
const SECRET = "truth";
let data = {}, currentPage = "home";

function check(){if(document.getElementById("secretInput").value.trim().toLowerCase()===SECRET){
  document.querySelector("div[style*='text-align']").style.display="none";
  document.getElementById("panel").style.display="block";
  loadData();
}}

async function loadData(){
  const r=await fetch("data.json?"+Date.now());
  data=await r.json();
  ["home","podcast","blog","shop"].forEach(p=>renderSlides(p));
}

function renderSlides(page){
  const container=document.getElementById("slides-"+page);
  container.innerHTML="";
  (data.heroSlides?.[page]||[]).forEach((s,i)=>{
    const div=document.createElement("div");div.className="slide";
    div.innerHTML=`
      <input placeholder="Title (use <br> for line break)" value="${s.title||''}">
      <input placeholder="Subtitle" value="${s.subtitle||''}">
      <input placeholder="Button text" value="${s.buttonText||''}">
      <input placeholder="Button link" value="${s.buttonLink||''}">
      <input placeholder="Image URL" value="${s.image||''}" style="width:100%">
      <button onclick="this.parentElement.remove();saveAll()">Delete</button><hr>`;
    container.appendChild(div);
  });
}

function addSlide(page){
  const container=document.getElementById("slides-"+page);
  const div=document.createElement("div");div.className="slide";
  div.innerHTML=`<input placeholder="Title"><input placeholder="Subtitle"><input placeholder="Button text"><input placeholder="Button link"><input placeholder="Image URL" style="width:100%"><button onclick="this.parentElement.remove();saveAll()">Delete</button><hr>`;
  container.appendChild(div);
}

function openTab(page){
  document.querySelectorAll(".tabcontent").forEach(t=>t.classList.remove("active"));
  document.getElementById(page).classList.add("active");
  document.querySelectorAll(".tab button").forEach(b=>b.classList.remove("active"));
  event.target.classList.add("active");
  currentPage=page;
}

function saveAll(){
  ["home","podcast","blog","shop"].forEach(p=>{
    data.heroSlides[p]=[];
    document.querySelectorAll("#slides-"+p+" .slide").forEach(el=>{
      const inp=el.querySelectorAll("input");
      data.heroSlides[p].push({
        title:inp[0].value,
        subtitle:inp[1].value,
        buttonText:inp[2].value,
        buttonLink:inp[3].value,
        image:inp[4].value
      });
    });
  });
  document.getElementById("status").textContent="Saved locally â€“ ready for GitHub token whenever you want!";
  console.log(JSON.stringify(data,null,2));
}
</script>
</body>
</html>
