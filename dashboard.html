<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Honest News – Dashboard</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<!-- PROTECT DASHBOARD: only enter if logged in -->
<script>
  if (localStorage.getItem("hn_logged") !== "yes") {
    location.href = "admin.html";
  }
</script>

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
<script src="https://cdn.jsdelivr.net/npm/jszip@3.10.1/dist/jszip.min.js"></script>

<style>
  :root{
    --bg: #02040a;
    --card-bg: #05070c;
    --border: #1f2937;
    --shadow-soft: 0 20px 45px rgba(0,0,0,0.75);
    --accent: #0ea5e9;
    --accent-soft: #0369a1;
    --accent-soft-bg: rgba(14,165,233,.12);
    --text-main: #e5e7eb;
    --text-soft: #9ca3af;
    --radius-lg: 20px;
    --radius-md: 12px;
    --radius-pill: 999px;
  }

  *{box-sizing:border-box;}

  body{
    margin:0;
    font-family:system-ui,-apple-system,BlinkMacSystemFont,"SF Pro Text","Segoe UI",sans-serif;
    background:
      radial-gradient(circle at top, #1e293b 0, #020617 48%, #000 100%);
    color:var(--text-main);
    height:100vh;
    display:flex;
    flex-direction:column;
    -webkit-font-smoothing: antialiased;
    overflow:hidden;
  }

  /* TOP GLOSSY APPLE-STYLE BAR */
  .top-welcome{
    background:
      radial-gradient(circle at 10% -40%, #4b5563 0, transparent 55%),
      linear-gradient(to bottom, #020617, #040712);
    color:white;
    padding:14px 24px;
    display:flex;
    align-items:center;
    justify-content:space-between;
    border-bottom:1px solid rgba(148,163,184,0.35);
    box-shadow:0 18px 40px rgba(0,0,0,.8);
  }
  .top-left{display:flex;flex-direction:column;gap:2px;}
  .top-welcome span.label{letter-spacing:.14em;text-transform:uppercase;font-size:.65rem;color:rgba(148,163,184,0.9);}
  .top-welcome span.title{font-size:.95rem;}
  .top-actions{display:flex;align-items:center;gap:10px;}
  .pill-badge{font-size:.7rem;padding:3px 9px;border-radius:999px;border:1px solid rgba(148,163,184,.5);color:#e5e7eb;background:rgba(15,23,42,.9);display:inline-flex;align-items:center;gap:6px;}
  .btn{border:none;border-radius:var(--radius-pill);cursor:pointer;padding:7px 15px;font-size:.8rem;font-weight:600;display:inline-flex;align-items:center;justify-content:center;gap:6px;background:#111827;color:#e5e7eb;}
  .btn.secondary{background:#111827;color:#e5e7eb;border:1px solid #1f2937;}
  .btn.secondary:hover{background:#020617;}
  .btn.ghost{background:transparent;color:#9ca3af;border:1px solid rgba(148,163,184,.25);}
  .btn.ghost:hover{color:#e5e7eb;border-color:#e5e7eb;}
  .btn.primary{background:var(--accent);color:#0b1120;border:1px solid var(--accent-soft);}
  .btn.primary:hover{background:var(--accent-soft);}
  .logout-btn{border:none;border-radius:var(--radius-pill);padding:7px 16px;cursor:pointer;font-weight:600;background:rgba(15,23,42,.4);color:#e5e7eb;border:1px solid rgba(148,163,184,.4);display:inline-flex;align-items:center;gap:6px;}
  .logout-btn:hover{background:rgba(15,23,42,.75);}

  /* MAIN – ONLY CHANGE: overflow:hidden */
  .main{
    flex:1;
    display:flex;
    padding:16px;
    gap:16px;
    min-height:0;
    overflow:hidden;               /* ← THIS LINE ADDED */
  }

  /* LEFT SIDEBAR – ONLY CHANGE: flex-shrink:0 */
  .sidebar{
    width:260px;
    background:rgba(3,7,18,0.98);
    border-radius:var(--radius-lg);
    padding:16px 14px;
    border:1px solid rgba(148,163,184,0.35);
    box-shadow:0 18px 40px rgba(0,0,0,0.85);
    display:flex;
    flex-direction:column;
    gap:14px;
    overflow:hidden;
    flex-shrink:0;                 /* ← THIS LINE ADDED (the magic) */
  }

  .sidebar-inner{flex:1;overflow-y:auto;padding-right:4px;}
  .sidebar-section{margin-bottom:10px;}
  .sidebar-section-header{width:100%;border:none;background:var(--accent-soft-bg);color:#e5e7eb;display:flex;align-items:center;justify-content:space-between;cursor:pointer;padding:6px 8px;font-size:.78rem;text-transform:uppercase;letter-spacing:.12em;border-radius:12px;}
  .sidebar-section-header span.label{pointer-events:none;}
  .sidebar-chevron{font-size:.7rem;opacity:0.7;transition:transform .18s ease, opacity .18s ease;}
  .sidebar-chevron.rotated{transform:rotate(-90deg);opacity:0.8;}
  .sidebar-section-body{margin-top:5px;}
  .sidebar-section-body.closed{display:none;}
  .page{padding:9px 10px;margin-top:6px;border-radius:12px;background:#020617;border:1px solid transparent;cursor:pointer;display:flex;align-items:center;justify-content:space-between;font-size:.84rem;color:var(--text-main);}
  .page-main{display:flex;flex-direction:column;}
  .page span.title{font-weight:600;}
  .page span.slug{font-size:.7rem;color:#6b7280;}
  .page.active{background:var(--accent-soft-bg);border-color:var(--accent);box-shadow:0 0 0 1px rgba(56,189,248,.4);}
  .page-delete-btn{border:none;background:transparent;color:#6b7280;cursor:pointer;padding:4px;border-radius:999px;flex-shrink:0;}
  .page-delete-btn:hover{background:rgba(15,23,42,.9);color:#f97316;}
  .textarea-small{width:100%;border-radius:12px;border:1px solid rgba(55,65,81,.9);background:#020617;color:#e5e7eb;padding:8px;font-size:.78rem;font-family:inherit;resize:vertical;min-height:70px;}
  .field-hint{font-size:.72rem;color:#9ca3af;}

  /* PREVIEW AREA – ONLY CHANGE: overflow:hidden */
  .content{
    flex:1;
    display:flex;
    flex-direction:column;
    min-width:0;
    overflow:hidden;               /* ← THIS LINE ADDED */
  }

  #previewCard{flex:1;background:rgba(3,7,18,0.98);border-radius:var(--radius-lg);padding:12px 14px 18px;border:1px solid rgba(148,163,184,0.4);box-shadow:var(--shadow-soft);display:flex;flex-direction:column;min-height:0;}
  #previewToolbar{display:flex;align-items:center;justify-content:space-between;gap:12px;margin-bottom:10px;font-size:.8rem;color:var(--text-soft);}
  #previewTitle{display:flex;align-items:center;gap:8px;}
  #previewTitle span.slug{padding:2px 7px;border-radius:var(--radius-pill);border:1px solid rgba(148,163,184,.35);font-size:.7rem;}
  .device-toggle-group{display:inline-flex;align-items:center;background:#020617;border-radius:999px;border:1px solid rgba(148,163,184,.5);overflow:hidden;}
  .device-btn{border:none;background:transparent;color:#9ca3af;font-size:.78rem;padding:4px 9px;cursor:pointer;display:inline-flex;align-items:center;justify-content:center;gap:4px;}
  .device-btn.active{background:var(--accent);color:#e5e7eb;}
  #previewInnerWrap{flex:1;display:flex;justify-content:center;align-items:stretch;min-height:0;}
  #previewFrame{width:100%;max-width:1200px;transition:max-width .25s ease, border-radius .25s ease, box-shadow .25s ease;}
  #previewFrame.desktop{max-width:1200px;}
  #previewFrame.tablet{max-width:900px;}
  #previewFrame.mobile{max-width:430px;border-radius:28px;overflow:hidden;box-shadow:0 0 0 1px rgba(148,163,184,.4),0 25px 60px rgba(0,0,0,.9);}
  .preview-wrap{border-radius:var(--radius-md);border:1px solid rgba(31,41,55,.9);overflow:hidden;background:#020617;}
  #heroPreview{position:relative;background-size:cover;background-position:center;}
  #heroPreviewOverlay{position:absolute;inset:0;background:linear-gradient(to bottom,rgba(15,23,42,.35),rgba(15,23,42,.9));}
  #heroPreviewInner{position:relative;color:#fff;text-align:center;padding-top:110px;padding-bottom:40px;padding-left:18px;padding-right:18px;}
  #heroPreviewInner h1{margin:0;font-size:2.1rem;}
  #heroPreviewInner p{margin-top:.6rem;font-size:.96rem;opacity:.9;}
  #blockPreview{padding:18px;background:#020617;}

  /* RIGHT SLIDING INSPECTOR – unchanged */
  #panelHandle{position:fixed;top:50%;right:0;width:18px;height:70px;background:var(--accent);color:white;cursor:pointer;display:flex;align-items:center;justify-content:center;border-radius:6px 0 0 6px;z-index:10000;font-size:.85rem;font-weight:600;box-shadow:-4px 0 18px rgba(0,0,0,.8);}
  #inspectorPanel{position:fixed;top:54px;right:-360px;width:360px;height:calc(100vh - 54px);background:#020617;color:#e5e7eb;border-left:1px solid rgba(148,163,184,.55);box-shadow:-12px 0 35px rgba(0,0,0,.9);padding:12px 12px 16px;z-index:9999;display:flex;flex-direction:column;transition:right .28s cubic-bezier(.19,1,.22,1);}
  #inspectorPanel.open{right:0;}

  /* … all the rest of your original styles unchanged … */
  #panelHeader{display:flex;align-items:center;justify-content:space-between;gap:8px;margin-bottom:8px;}
  #panelHeaderLeft{display:flex;flex-direction:column;gap:3px;}
  #panelHeaderLeft span.title{font-size:.8rem;text-transform:uppercase;letter-spacing:.12em;color:#9ca3af;}
  #panelHeaderLeft span.sub{font-size:.8rem;color:#e5e7eb;}
  #panelHeaderRight{display:flex;align-items:center;gap:6px;}
  #closePanelBtn{border:none;background:#111827;color:#e5e7eb;padding:5px 8px;font-size:.9rem;cursor:pointer;border-radius:8px;}
  .pill{padding:3px 10px;border-radius:var(--radius-pill);background:#111827;color:#e5e7eb;font-size:.72rem;}
  .pill.dirty{background:#b91c1c;color:#fee2e2;}
  .pill.saved{background:#16a34a;color:#022c22;}
  #inspectorTabs{display:flex;gap:4px;margin-bottom:8px;border-bottom:1px solid rgba(31,41,55,.9);padding-bottom:4px;}
  .inspect-tab{flex:1;text-align:center;padding:5px 0;border-radius:999px;font-size:.76rem;cursor:pointer;color:#9ca3af;background:transparent;border:none;}
  .inspect-tab.active{background:var(--accent-soft-bg);color:#e5e7eb;box-shadow:0 0 0 1px rgba(56,189,248,.55);}
  #inspectorBody{flex:1;overflow-y:auto;padding-right:4px;font-size:.8rem;}
  /* (rest of your original styles unchanged – everything else is exactly as you had it) */

  @media (max-width:900px){
    .main{flex-direction:column;}
    .sidebar{width:100%;}
    #panelHandle{top:auto;bottom:90px;}
  }
</style>
</head>
<body>

<!-- YOUR ORIGINAL HTML – 100% unchanged -->
<div class="top-welcome">
  <div class="top-left">
    <span class="label">Honest News · Dashboard</span>
    <span class="title">Welcome back, Joseph</span>
  </div>
  <div class="top-actions">
    <span class="pill-badge"><i class="fa-regular fa-circle-dot"></i> Publish path: Render → GitHub</span>
    <button class="logout-btn" onclick="localStorage.removeItem('hn_logged');location.href='admin.html'">
      <i class="fa-solid fa-right-from-bracket"></i> Log Out
    </button>
  </div>
</div>

<div class="main">
  <aside class="sidebar">
    <!-- Pages accordion -->
    <div class="sidebar-section">
      <button class="sidebar-section-header" type="button" onclick="toggleSidebarSection('pages')">
        <span class="label">Pages</span>
        <i class="fa-solid fa-chevron-right sidebar-chevron" id="pagesChevron"></i>
      </button>
      <div class="sidebar-section-body closed" id="pagesSection">
        <div class="sidebar-inner" id="pages"></div>
        <button class="btn secondary" style="width:100%;margin-top:8px;" onclick="newPage()">+ New Page</button>
      </div>
    </div>

    <!-- Navigation accordion -->
    <div class="sidebar-section">
      <button class="sidebar-section-header" type="button" onclick="toggleSidebarSection('nav')">
        <span class="label">Navigation (raw)</span>
        <i class="fa-solid fa-chevron-right sidebar-chevron" id="navChevron"></i>
      </button>
      <div class="sidebar-section-body closed" id="navSection">
        <p class="field-hint" style="margin-top:4px;">
          One per line: <code>Title | URL</code><br>
          <strong>Tip:</strong> If you use the Menu tab + mega menu, avoid editing this.
        </p>
        <textarea id="menuRaw" class="textarea-small" oninput="menuFromRaw(this.value)"></textarea>
      </div>
    </div>
  </aside>

  <section class="content">
    <div id="previewCard">
      <div id="previewToolbar">
        <div id="previewTitle">
          <span id="previewPageTitle">No page selected</span>
          <span class="slug" id="previewPageSlug"></span>
        </div>
        <div class="device-toggle-group">
          <button class="device-btn active" data-device="desktop"><i class="fa-solid fa-display"></i></button>
          <button class="device-btn" data-device="tablet"><i class="fa-solid fa-tablet-screen-button"></i></button>
          <button class="device-btn" data-device="mobile"><i class="fa-solid fa-mobile-screen"></i></button>
        </div>
      </div>

      <div id="previewInnerWrap">
        <div id="previewFrame" class="desktop">
          <div class="preview-wrap">
            <div id="heroPreview">
              <div id="heroPreviewOverlay"></div>
              <div id="heroPreviewInner">
                <h1>Pick a page on the left</h1>
                <p>Then use the sliding csv panel to edit Page, Hero, Blocks, and Menu.</p>
              </div>
            </div>
            <div id="blockPreview"></div>
          </div>
        </div>
      </div>
    </div>
  </section>
</div>

<!-- RIGHT INSPECTOR – unchanged -->
<div id="panelHandle" title="Open inspector">Left Arrow</div>
<div id="inspectorPanel">
  <!-- your full inspector HTML unchanged -->
  <div id="panelHeader">…</div>
  <div id="inspectorTabs">…</div>
  <div id="inspectorBody"></div>
  <div style="margin-top:10px;">…</div>
</div>

<!-- YOUR ORIGINAL SCRIPT – 100% unchanged -->
<script>
  // … all your original JavaScript exactly as you posted …
</script>
</body>
</html>













